!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.listComponent=f()}}(function(){var define;return require=function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","../authentication"],factory)}(function(require,exports){"use strict";var authentication_1=require("../authentication");!function(AuthenticationMode){AuthenticationMode[AuthenticationMode.Dialog=0]="Dialog",AuthenticationMode[AuthenticationMode.Redirect=1]="Redirect"}(exports.AuthenticationMode||(exports.AuthenticationMode={}));var AuthenticationMode=exports.AuthenticationMode,Authenticator=function(){function Authenticator(_endpointManager,_tokenManager){if(this._endpointManager=_endpointManager,this._tokenManager=_tokenManager,null==_endpointManager)throw"Please pass an instance of EndpointManager.";if(null==_tokenManager)throw"Please pass an instance of TokenManager.";if(0==_endpointManager.count)throw"No registered Endpoints could be found. Either use the default endpoint registrations or add one manually"}return Authenticator.prototype.authenticate=function(provider,force){void 0===force&&(force=!1);var token=this._tokenManager.get(provider);if(null!=token&&!force)return Promise.resolve(token);var endpoint=this._endpointManager.get(provider);if(Authenticator.mode==AuthenticationMode.Redirect){var url=authentication_1.EndpointManager.getLoginUrl(endpoint);return location.replace(url),Promise.reject("AUTH_REDIRECT")}var auth;return auth=Authenticator.isAddin?this._openInDialog(endpoint):this._openInWindowPopup(endpoint),auth.catch(function(error){return console.error(error)})},Authenticator.prototype.exchangeCodeForToken=function(url,data,headers){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("POST",url),xhr.setRequestHeader("Accept","application/json"),xhr.setRequestHeader("Content-Type","application/json");for(var header in headers)"Accept"!==header&&"Content-Type"!==header&&xhr.setRequestHeader(header,headers[header]);xhr.onload=function(){try{if(200===xhr.status){var json=JSON.parse(xhr.responseText);"access_token"in json?resolve(json):reject(json)}else 200!==xhr.status&&reject({error:"Request failed. "+xhr.response})}catch(e){reject({error:e})}},xhr.send(JSON.stringify(data))})},Object.defineProperty(Authenticator,"isDialog",{get:function(){if(Authenticator.isAddin){if(!authentication_1.TokenManager.isTokenUrl(location.href))return!1;var token=authentication_1.TokenManager.getToken(location.href,location.origin);return Office.context.ui.messageParent(JSON.stringify(token)),!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(Authenticator,"isAddin",{get:function(){return null==Authenticator._isAddin&&(Authenticator._isAddin=window.hasOwnProperty("Office")&&(window.hasOwnProperty("Word")||window.hasOwnProperty("Excel")||window.hasOwnProperty("OneNote"))),Authenticator._isAddin},set:function(value){Authenticator._isAddin=value},enumerable:!0,configurable:!0}),Authenticator.prototype._openInWindowPopup=function(endpoint){var _this=this,url=authentication_1.EndpointManager.getLoginUrl(endpoint),windowSize=endpoint.windowSize||"width=400,height=600",windowFeatures=windowSize+",menubar=no,toolbar=no,location=no,resizable=no,scrollbars=yes,status=no",popupWindow=window.open(url,endpoint.provider.toUpperCase(),windowFeatures);return new Promise(function(resolve,reject){try{var interval_1=setInterval(function(){try{if(popupWindow.document.URL.indexOf(endpoint.redirectUrl)!==-1){clearInterval(interval_1);var result=authentication_1.TokenManager.getToken(popupWindow.document.URL,endpoint.redirectUrl);null==result?reject("No access_token or code could be parsed."):"code"in result?(popupWindow.close(),""!=endpoint.tokenUrl&&resolve(_this.exchangeCodeForToken(endpoint.tokenUrl,result.code)),resolve(result)):"access_token"in result?(_this._tokenManager.add(endpoint.provider,result),popupWindow.close(),resolve(result)):reject(result)}}catch(exception){popupWindow||(clearInterval(interval_1),reject(exception))}},400)}catch(exception){popupWindow.close(),reject(exception)}})},Authenticator.prototype._openInDialog=function(endpoint){var _this=this,url=authentication_1.EndpointManager.getLoginUrl(endpoint),options={height:35,width:35,requireHTTPS:!0};return new Promise(function(resolve,reject){Office.context.ui.displayDialogAsync(url,options,function(result){var dialog=result.value;dialog.addEventHandler(Office.EventType.DialogMessageReceived,function(args){dialog.close();try{null!=args.message&&""!==args.message||reject("No access_token or code could be parsed.");var json=JSON.parse(args.message);"code"in json?(""!=endpoint.tokenUrl&&resolve(_this.exchangeCodeForToken(endpoint.tokenUrl,json.code)),resolve(json)):"access_token"in json?(_this._tokenManager.add(endpoint.provider,json),resolve(json)):reject(json)}catch(exception){reject(exception)}})})})},Authenticator.mode=AuthenticationMode.Dialog,Authenticator}();exports.Authenticator=Authenticator})},{"../authentication":3}],2:[function(require,module,exports){var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)};!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","../helpers"],factory)}(function(require,exports){"use strict";var helpers_1=require("../helpers"),extend=function(obj){for(var defaults=[],_i=1;_i<arguments.length;_i++)defaults[_i-1]=arguments[_i];var length=arguments.length;if(length<2||null==obj)return obj;defaults&&(obj=Object(obj));for(var index=1;index<length;index++){var source=arguments[index];if(null!=source)for(var keys=Object.keys(source),l=keys.length,i=0;i<l;i++){var key=keys[i];defaults&&void 0!==obj[key]||(obj[key]=source[key])}}return obj};exports.DefaultEndpoints={Google:"Google",Microsoft:"Microsoft",Facebook:"Facebook"};var EndpointManager=function(_super){function EndpointManager(){_super.call(this,"OAuth2Endpoints",helpers_1.StorageType.LocalStorage)}return __extends(EndpointManager,_super),Object.defineProperty(EndpointManager.prototype,"currentHost",{get:function(){return null==this._currentHost&&(this._currentHost=window.location.protocol+"//"+window.location.host),this._currentHost},enumerable:!0,configurable:!0}),EndpointManager.prototype.add=function(provider,config){return null==config.redirectUrl&&(config.redirectUrl=this.currentHost),config.provider=provider,_super.prototype.add.call(this,provider,config)},EndpointManager.prototype.registerGoogleAuth=function(clientId,overrides){var defaults={clientId:clientId,baseUrl:"https://accounts.google.com",authorizeUrl:"/o/oauth2/v2/auth",resource:"https://www.googleapis.com",responseType:"token",scope:"https://www.googleapis.com/auth/plus.me"},config=extend({},defaults,overrides);return this.add(exports.DefaultEndpoints.Google,config)},EndpointManager.prototype.registerMicrosoftAuth=function(clientId,overrides){var defaults={clientId:clientId,baseUrl:"https://login.microsoftonline.com/common/oauth2/v2.0",authorizeUrl:"/authorize",resource:"https://graph.microsoft.com",responseType:"id_token+token",scope:"openid https://graph.microsoft.com/user.read",extraParameters:"&response_mode=fragment",nonce:!0,state:!0},config=extend({},defaults,overrides);this.add(exports.DefaultEndpoints.Microsoft,config)},EndpointManager.prototype.registerFacebookAuth=function(clientId,overrides){var defaults={clientId:clientId,baseUrl:"https://www.facebook.com",authorizeUrl:"/dialog/oauth",resource:"https://graph.facebook.com",responseType:"token",scope:"public_profile",nonce:!0,state:!0},config=extend({},defaults,overrides);this.add(exports.DefaultEndpoints.Facebook,config)},EndpointManager.getLoginUrl=function(endpointConfig){var rand=function(limit,start){return void 0===limit&&(limit=10),void 0===start&&(start=0),Math.floor(Math.random()*limit+start)},oAuthScope=endpointConfig.scope?encodeURIComponent(endpointConfig.scope):"",state=endpointConfig.state&&rand(1e4),nonce=endpointConfig.nonce&&rand(1e4),urlSegments=["response_type="+endpointConfig.responseType,"client_id="+encodeURIComponent(endpointConfig.clientId),"redirect_uri="+encodeURIComponent(endpointConfig.redirectUrl),"scope="+oAuthScope];return state&&urlSegments.push("state="+state),nonce&&urlSegments.push("nonce="+nonce),endpointConfig&&urlSegments.push(endpointConfig.extraQueryParameters),endpointConfig.baseUrl+endpointConfig.authorizeUrl+"?"+urlSegments.join("&")},EndpointManager}(helpers_1.Storage);exports.EndpointManager=EndpointManager})},{"../helpers":6}],3:[function(require,module,exports){!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","./authenticator","./endpoint.manager","./token.manager"],factory)}(function(require,exports){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}__export(require("./authenticator")),__export(require("./endpoint.manager")),__export(require("./token.manager"))})},{"./authenticator":1,"./endpoint.manager":2,"./token.manager":4}],4:[function(require,module,exports){var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)};!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","../helpers"],factory)}(function(require,exports){"use strict";var helpers_1=require("../helpers"),TokenManager=function(_super){function TokenManager(){_super.call(this,"OAuth2Tokens",helpers_1.StorageType.LocalStorage)}return __extends(TokenManager,_super),TokenManager.prototype.setExpiry=function(token){var expire=function(seconds){return void 0===seconds&&(seconds=3600),new Date((new Date).getTime()+1e3*~~seconds)};return null==token?null:void(null==token.expires_at&&(token.expires_at=expire(token.expires_in)))},TokenManager.prototype.add=function(provider,value){return value.provider=provider,this.setExpiry(value),_super.prototype.add.call(this,provider,value)},TokenManager.getToken=function(url,exclude,delimiter){void 0===delimiter&&(delimiter="#"),exclude&&(url=url.replace(exclude,""));var parts=url.split(delimiter);if(!(parts.length<=0)){var rightPart=parts.length>=2?parts[1]:parts[0];if(rightPart=rightPart.replace("/",""),rightPart.indexOf("?")!==-1){var queryPart=rightPart.split("?");if(!queryPart||queryPart.length<=0)return;rightPart=queryPart[1]}return this._extractParams(rightPart)}},TokenManager.isTokenUrl=function(url){var regex=/(access_token|code|error)/gi;return regex.test(url)},TokenManager._extractParams=function(segment){for(var matches,params={},regex=/([^&=]+)=([^&]*)/g;null!==(matches=regex.exec(segment));)params[decodeURIComponent(matches[1])]=decodeURIComponent(matches[2]);return params},TokenManager}(helpers_1.Storage);exports.TokenManager=TokenManager})},{"../helpers":6}],5:[function(require,module,exports){!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports"],factory)}(function(require,exports){"use strict";var Dictionary=function(){function Dictionary(items){this.items=items,null==this.items&&(this.items={})}return Dictionary.prototype.get=function(key){if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");return this.contains(key)?this.items[key]:null},Dictionary.prototype.add=function(key,value){if(this.contains(key))throw new Error("Key already exists.");return this.insert(key,value)},Dictionary.prototype.first=function(){if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");var key=this.keys()[0];if(null!=key)return this.items[key]},Dictionary.prototype.insert=function(key,value){if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");if(null==value)throw new Error("Value expected. Got "+value);return this.items[key]=value,value},Dictionary.prototype.remove=function(key){if(!this.contains(key))throw new Error("Key not found.");var value=this.items[key];return delete this.items[key],this.insert(key,value)},Dictionary.prototype.clear=function(){this.items={}},Dictionary.prototype.contains=function(key){if(null==key)throw new Error("Key cannot be null or undefined");if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");return this.items.hasOwnProperty(key)},Dictionary.prototype.keys=function(){if(null==this)throw new Error("Dictionary isn't initialized. Call 'new' first.");return Object.keys(this.items)},Dictionary.prototype.values=function(){if(null==this)throw new Error("Dictionary isn't initialized. Call 'new' first.");return Object.values(this.items)},Dictionary.prototype.lookup=function(){return this.keys().length?this.items:null},Object.defineProperty(Dictionary.prototype,"count",{get:function(){return this.values().length},enumerable:!0,configurable:!0}),Dictionary}();exports.Dictionary=Dictionary})},{}],6:[function(require,module,exports){!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","./dictionary","./storage"],factory)}(function(require,exports){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}__export(require("./dictionary")),__export(require("./storage"))})},{"./dictionary":5,"./storage":7}],7:[function(require,module,exports){var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)};!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","./dictionary"],factory)}(function(require,exports){"use strict";var dictionary_1=require("./dictionary");!function(StorageType){StorageType[StorageType.LocalStorage=0]="LocalStorage",StorageType[StorageType.SessionStorage=1]="SessionStorage"}(exports.StorageType||(exports.StorageType={}));var StorageType=exports.StorageType,Storage=function(_super){function Storage(_container,type){_super.call(this),this._container=_container,this._storage=null,type=type||StorageType.LocalStorage,this.switchStorage(type)}return __extends(Storage,_super),Storage.prototype.switchStorage=function(type){this._storage=type===StorageType.LocalStorage?localStorage:sessionStorage,this._storage.hasOwnProperty(this._container)||(this._storage[this._container]=null),this._load()},Storage.prototype.add=function(item,value){return _super.prototype.insert.call(this,item,value),this._save(),value},Storage.prototype.remove=function(item){var value=_super.prototype.remove.call(this,item);return this._save(),value},Storage.prototype.clear=function(){_super.prototype.clear.call(this),this._storage[this._container]=null},Storage.clear=function(){window.localStorage.clear(),window.sessionStorage.clear()},Storage.prototype._save=function(){this._storage[this._container]=JSON.stringify(this.items)},Storage.prototype._load=function(){return _super.prototype.clear.call(this),this.items=JSON.parse(this._storage[this._container]),null==this.items&&(this.items={}),this.items},Storage}(dictionary_1.Dictionary);exports.Storage=Storage})},{"./dictionary":5}],"office-js-helpers":[function(require,module,exports){!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","./helpers","./authentication"],factory)}(function(require,exports){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}__export(require("./helpers")),__export(require("./authentication"))})},{"./authentication":3,"./helpers":6}]},{},[]),require("office-js-helpers")});