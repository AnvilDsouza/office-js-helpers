!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.listComponent=e()}}(function(){var e;return require=function e(t,o,n){function r(s,a){if(!o[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var p=o[s]={exports:{}};t[s][0].call(p.exports,function(e){var o=t[s][1][e];return r(o?o:e)},p,p.exports,e,t,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,o,n){!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../authentication"],r)}(function(e,t){"use strict";var o=e("../authentication");!function(e){e[e.Dialog=0]="Dialog",e[e.Redirect=1]="Redirect"}(t.AuthenticationMode||(t.AuthenticationMode={}));var n=t.AuthenticationMode,r=function(){function e(e,t){if(this._endpointManager=e,this._tokenManager=t,null==e)throw"Please pass an instance of EndpointManager.";if(null==t)throw"Please pass an instance of TokenManager.";if(0==e.count)throw"No registered Endpoints could be found. Either use the default endpoint registrations or add one manually"}return e.prototype.authenticate=function(t,r){void 0===r&&(r=!1);var i=this._tokenManager.get(t);if(null!=i&&!r)return Promise.resolve(i);var s=this._endpointManager.get(t);if(e.mode==n.Redirect){var a=o.EndpointManager.getLoginUrl(s);return location.replace(a),Promise.reject("AUTH_REDIRECT")}var c;return c=e.isAddin?this._openInDialog(s):this._openInWindowPopup(s),c.catch(function(e){return console.error(e)})},e.prototype.exchangeCodeForToken=function(e,t,o){return new Promise(function(n,r){var i=new XMLHttpRequest;i.open("POST",e),i.setRequestHeader("Accept","application/json"),i.setRequestHeader("Content-Type","application/json");for(var s in o)"Accept"!==s&&"Content-Type"!==s&&i.setRequestHeader(s,o[s]);i.onload=function(){try{if(200===i.status){var e=JSON.parse(i.responseText);"access_token"in e?n(e):r(e)}else 200!==i.status&&r({error:"Request failed. "+i.response})}catch(e){r({error:e})}},i.send(JSON.stringify(t))})},Object.defineProperty(e,"isAuthDialog",{get:function(){if(e.isAddin){if(!o.TokenManager.isTokenUrl(location.href))return!1;var t=o.TokenManager.getToken(location.href,location.origin);return Office.context.ui.messageParent(JSON.stringify(t)),!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isAddin",{get:function(){return null==e._isAddin&&(e._isAddin=window.hasOwnProperty("Office")&&(window.hasOwnProperty("Word")||window.hasOwnProperty("Excel")||window.hasOwnProperty("OneNote"))),e._isAddin},set:function(t){e._isAddin=t},enumerable:!0,configurable:!0}),e.prototype._openInWindowPopup=function(e){var t=this,n=o.EndpointManager.getLoginUrl(e),r=e.windowSize||"width=400,height=600",i=r+",menubar=no,toolbar=no,location=no,resizable=no,scrollbars=yes,status=no",s=window.open(n,e.provider.toUpperCase(),i);return new Promise(function(n,r){try{var i=setInterval(function(){try{if(s.document.URL.indexOf(e.redirectUrl)!==-1){clearInterval(i);var a=o.TokenManager.getToken(s.document.URL,e.redirectUrl);null==a?r("No access_token or code could be parsed."):"code"in a?(s.close(),""!=e.tokenUrl&&n(t.exchangeCodeForToken(e.tokenUrl,a.code)),n(a)):"access_token"in a?(t._tokenManager.add(e.provider,a),s.close(),n(a)):r(a)}}catch(e){s||(clearInterval(i),r(e))}},400)}catch(e){s.close(),r(e)}})},e.prototype._openInDialog=function(e){var t=this,n=o.EndpointManager.getLoginUrl(e),r={height:35,width:35,requireHTTPS:!0};return new Promise(function(o,i){Office.context.ui.displayDialogAsync(n,r,function(n){var r=n.value;r.addEventHandler(Office.EventType.DialogMessageReceived,function(n){r.close();try{null!=n.message&&""!==n.message||i("No access_token or code could be parsed.");var s=JSON.parse(n.message);"code"in s?(""!=e.tokenUrl&&o(t.exchangeCodeForToken(e.tokenUrl,s.code)),o(s)):"access_token"in s?(t._tokenManager.add(e.provider,s),o(s)):i(s)}catch(e){i(e)}})})})},e.mode=n.Dialog,e}();t.Authenticator=r})},{"../authentication":3}],2:[function(t,o,n){var r=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../helpers"],r)}(function(e,t){"use strict";var o=e("../helpers"),n=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=arguments.length;if(n<2||null==e)return e;t&&(e=Object(e));for(var r=1;r<n;r++){var i=arguments[r];if(null!=i)for(var s=Object.keys(i),a=s.length,c=0;c<a;c++){var u=s[c];t&&void 0!==e[u]||(e[u]=i[u])}}return e};t.DefaultEndpoints={Google:"Google",Microsoft:"Microsoft",Facebook:"Facebook"};var i=function(e){function i(){e.call(this,"OAuth2Endpoints",o.StorageType.LocalStorage)}return r(i,e),Object.defineProperty(i.prototype,"currentHost",{get:function(){return null==this._currentHost&&(this._currentHost=window.location.protocol+"//"+window.location.host),this._currentHost},enumerable:!0,configurable:!0}),i.prototype.add=function(t,o){return null==o.redirectUrl&&(o.redirectUrl=this.currentHost),o.provider=t,e.prototype.add.call(this,t,o)},i.prototype.registerGoogleAuth=function(e,o){var r={clientId:e,baseUrl:"https://accounts.google.com",authorizeUrl:"/o/oauth2/v2/auth",resource:"https://www.googleapis.com",responseType:"token",scope:"https://www.googleapis.com/auth/plus.me"},i=n({},r,o);return this.add(t.DefaultEndpoints.Google,i)},i.prototype.registerMicrosoftAuth=function(e,o){var r={clientId:e,baseUrl:"https://login.microsoftonline.com/common/oauth2/v2.0",authorizeUrl:"/authorize",resource:"https://graph.microsoft.com",responseType:"id_token+token",scope:"openid https://graph.microsoft.com/user.read",extraParameters:"&response_mode=fragment",nonce:!0,state:!0},i=n({},r,o);this.add(t.DefaultEndpoints.Microsoft,i)},i.prototype.registerFacebookAuth=function(e,o){var r={clientId:e,baseUrl:"https://www.facebook.com",authorizeUrl:"/dialog/oauth",resource:"https://graph.facebook.com",responseType:"token",scope:"public_profile",nonce:!0,state:!0},i=n({},r,o);this.add(t.DefaultEndpoints.Facebook,i)},i.getLoginUrl=function(e){var t=function(e,t){return void 0===e&&(e=10),void 0===t&&(t=0),Math.floor(Math.random()*e+t)},o=e.scope?encodeURIComponent(e.scope):"",n=e.state&&t(1e4),r=e.nonce&&t(1e4),i=["response_type="+e.responseType,"client_id="+encodeURIComponent(e.clientId),"redirect_uri="+encodeURIComponent(e.redirectUrl),"scope="+o];return n&&i.push("state="+n),r&&i.push("nonce="+r),e&&i.push(e.extraQueryParameters),e.baseUrl+e.authorizeUrl+"?"+i.join("&")},i}(o.Storage);t.EndpointManager=i})},{"../helpers":6}],3:[function(t,o,n){!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./authenticator","./endpoint.manager","./token.manager"],r)}(function(e,t){"use strict";function o(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}o(e("./authenticator")),o(e("./endpoint.manager")),o(e("./token.manager"))})},{"./authenticator":1,"./endpoint.manager":2,"./token.manager":4}],4:[function(t,o,n){var r=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../helpers"],r)}(function(e,t){"use strict";var o=e("../helpers"),n=function(e){function t(){e.call(this,"OAuth2Tokens",o.StorageType.LocalStorage)}return r(t,e),t.prototype.setExpiry=function(e){var t=function(e){return void 0===e&&(e=3600),new Date((new Date).getTime()+1e3*~~e)};return null==e?null:void(null==e.expires_at&&(e.expires_at=t(e.expires_in)))},t.prototype.add=function(t,o){return o.provider=t,this.setExpiry(o),e.prototype.add.call(this,t,o)},t.getToken=function(e,t,o){void 0===o&&(o="#"),t&&(e=e.replace(t,""));var n=e.split(o);if(!(n.length<=0)){var r=n.length>=2?n[1]:n[0];if(r=r.replace("/",""),r.indexOf("?")!==-1){var i=r.split("?");if(!i||i.length<=0)return;r=i[1]}return this._extractParams(r)}},t.isTokenUrl=function(e){var t=/(access_token|code|error)/gi;return t.test(e)},t._extractParams=function(e){for(var t,o={},n=/([^&=]+)=([^&]*)/g;null!==(t=n.exec(e));)o[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return o},t}(o.Storage);t.TokenManager=n})},{"../helpers":6}],5:[function(t,o,n){!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var o=function(){function e(e){this.items=e,null==this.items&&(this.items={})}return e.prototype.get=function(e){if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");return this.contains(e)?this.items[e]:null},e.prototype.add=function(e,t){if(this.contains(e))throw new Error("Key already exists.");return this.insert(e,t)},e.prototype.first=function(){if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");var e=this.keys()[0];if(null!=e)return this.items[e]},e.prototype.insert=function(e,t){if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");if(null==t)throw new Error("Value expected. Got "+t);return this.items[e]=t,t},e.prototype.remove=function(e){if(!this.contains(e))throw new Error("Key not found.");var t=this.items[e];return delete this.items[e],this.insert(e,t)},e.prototype.clear=function(){this.items={}},e.prototype.contains=function(e){if(null==e)throw new Error("Key cannot be null or undefined");if(null==this.items)throw new Error("Dictionary isn't initialized. Call 'new' first.");return this.items.hasOwnProperty(e)},e.prototype.keys=function(){if(null==this)throw new Error("Dictionary isn't initialized. Call 'new' first.");return Object.keys(this.items)},e.prototype.values=function(){if(null==this)throw new Error("Dictionary isn't initialized. Call 'new' first.");return Object.values(this.items)},e.prototype.lookup=function(){return this.keys().length?this.items:null},Object.defineProperty(e.prototype,"count",{get:function(){return this.values().length},enumerable:!0,configurable:!0}),e}();t.Dictionary=o})},{}],6:[function(t,o,n){!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./dictionary","./storage"],r)}(function(e,t){"use strict";function o(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}o(e("./dictionary")),o(e("./storage"))})},{"./dictionary":5,"./storage":7}],7:[function(t,o,n){var r=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./dictionary"],r)}(function(e,t){"use strict";var o=e("./dictionary");!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(t.StorageType||(t.StorageType={}));var n=t.StorageType,i=function(e){function t(t,o){e.call(this),this._container=t,this._storage=null,o=o||n.LocalStorage,this.switchStorage(o)}return r(t,e),t.prototype.switchStorage=function(e){this._storage=e===n.LocalStorage?localStorage:sessionStorage,this._storage.hasOwnProperty(this._container)||(this._storage[this._container]=null),this._load()},t.prototype.add=function(t,o){return e.prototype.insert.call(this,t,o),this._save(),o},t.prototype.remove=function(t){var o=e.prototype.remove.call(this,t);return this._save(),o},t.prototype.clear=function(){e.prototype.clear.call(this),this._storage[this._container]=null},t.clear=function(){window.localStorage.clear(),window.sessionStorage.clear()},t.prototype._save=function(){this._storage[this._container]=JSON.stringify(this.items)},t.prototype._load=function(){return e.prototype.clear.call(this),this.items=JSON.parse(this._storage[this._container]),null==this.items&&(this.items={}),this.items},t}(o.Dictionary);t.Storage=i})},{"./dictionary":5}],"office-js-helpers":[function(t,o,n){!function(r){if("object"==typeof o&&"object"==typeof o.exports){var i=r(t,n);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./helpers","./authentication"],r)}(function(e,t){"use strict";function o(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}o(e("./helpers")),o(e("./authentication"))})},{"./authentication":3,"./helpers":6}]},{},[]),require("office-js-helpers")});